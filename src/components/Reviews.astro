---
const reviewlink =
  "https://www.google.com/search?sca_esv=cb97f40da6f73026&sxsrf=AE3TifPz3LOwg_Ov5tXY6mNYVKA8W66-vQ:1761753571763&si=AMgyJEtREmoPL4P1I5IDCfuA8gybfVI2d5Uj7QMwYCZHKDZ-E8AjXHMpzZeMWW2sISDxyHIsR640xR8KXKlF9ShjnUc6GOTAWSUXgm1Be95iDAIlPAZjSUA2mBXFNIVb-s3Mb8oCiJ8Y&q=PaintCraft+Reviews&sa=X&ved=2ahUKEwiArM6-48mQAxVLVTABHSP6In4Q0bkNegQIIBAE&biw=1309&bih=738&dpr=2.2";

const reviews = [
  { author_name: "Deb Wingert", author_url: reviewlink, rating: 5, relative_time_description: "17 days ago", text: "Alex and the entire PaintCraft team were simply outstanding from beginning to end—organized, punctual, competent, excellent attention to detail, highly professional, polite, honest, respectful, timely. And your outstanding team packed up your materials." },
  { author_name: "Ami Schlamp", author_url: reviewlink, rating: 5, relative_time_description: "18 days ago", text: "The entire Paint Craft Team was incredible! From start to finish, with bidding, to painting to follow up, we couldn't have asked for a better team of painters. They were also able to make a very tight timeline happen! The actual paint job was flawless. Highly recommended and will be using them in the future!" },
  { author_name: "Anna Le", author_url: reviewlink, rating: 5, relative_time_description: "4 months ago", text: "PaintCraft did an amazing job removing the popcorn texture and painting the trim + baseboards for our future nursery. Communication was great from the beginning—we'll definitely hire them again for our next project." },
  { author_name: "Julie Oelschlaeger", author_url: reviewlink, rating: 5, relative_time_description: "5 months ago", text: "EXCELLENT company: They were professional, clean, friendly and did an absolutely fantastic job painting our Senior to doing more business in the future! Thanks so much!" },
  { author_name: "Sarah Johnson", author_url: reviewlink, rating: 5, relative_time_description: "3 months ago", text: "The team at PaintCraft transformed our home with a stunning paint job. Their attention to detail and friendly service made the process a breeze. Highly recommend!" },
  { author_name: "Michael Chen", author_url: reviewlink, rating: 5, relative_time_description: "6 months ago", text: "Fast, efficient, and top-notch quality. PaintCraft exceeded our expectations on our exterior repaint. Will definitely use again!" },
];

const rating = 5.0;
const count = 11;

const summary = [
  "Highly professional and punctual service",
  "Exceptional attention to detail",
  "Flawless paint jobs with tight timelines",
  "Excellent communication and customer care",
];
---

<section class="relative bg-gradient-to-b from-neutral-50 to-white pt-12 md:pt-16 pb-14 md:pb-20">
  <div class="mx-auto max-w-7xl px-6">
    <!-- Header with Schema.org markup for SEO -->
    <div class="mb-8 text-center">
      <h2 class="text-4xl md:text-5xl font-bold text-neutral-900 tracking-tight">
        Trusted by MN Homeowners
      </h2>
      <p class="mt-4 text-lg text-neutral-600 max-w-2xl mx-auto">
        See what homeowners are saying about working with our team
      </p>
    </div>

    <!-- Rating Summary with Schema.org microdata -->
    <div 
      class="mb-8 flex flex-wrap items-center justify-center gap-6 md:gap-8"
      itemscope 
      itemtype="https://schema.org/AggregateRating"
    >
      <div class="flex items-center gap-4">
        <span class="text-5xl md:text-6xl font-bold text-[#C48356]" itemprop="ratingValue">{rating.toFixed(1)}</span>
        <div>
          <div class="flex gap-1 mb-1">
            {Array.from({ length: 5 }).map((_, i) => (
              <svg viewBox="0 0 20 20" class={`h-6 w-6 ${i < Math.round(rating) ? 'fill-[#C48356]' : 'fill-neutral-300'}`} aria-hidden="true">
                <path d="m10 15.27 5.18 3.05-1.64-5.81 4.46-3.86-5.86-.5L10 2 7.86 8.15l-5.86.5 4.46 3.86-1.64 5.81L10 15.27z"/>
              </svg>
            ))}
          </div>
          <div class="text-sm text-neutral-600">
            <span itemprop="reviewCount">{count}</span> reviews on 
            <meta itemprop="bestRating" content="5" />
            <meta itemprop="worstRating" content="1" />
            <a
              href={reviewlink}
              target="_blank"
              rel="noopener"
              class="font-medium text-[#C48356] hover:underline"
            >
              Google
            </a>
          </div>

        </div>
      </div>

      <a 
        href={reviewlink} 
        target="_blank" 
        rel="noopener"
        class="inline-flex items-center gap-2 rounded-full bg-[#C48356] px-6 py-3 text-sm font-semibold text-white shadow-lg hover:bg-[#B47347] hover:shadow-xl transition-all duration-300 hover:-translate-y-0.5"
      >
        Read All Reviews
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
        </svg>
      </a>
    </div>

    <!-- Reviews Rail with proper padding to prevent clipping -->
    <div class="relative" style="--edge:80px;">
      <!-- Gradient fade edges -->
      <div class="pointer-events-none absolute inset-y-0 left-0 w-[var(--edge)] bg-gradient-to-r from-white via-white to-transparent z-10"></div>
      <div class="pointer-events-none absolute inset-y-0 right-0 w-[var(--edge)] bg-gradient-to-l from-white via-white to-transparent z-10"></div>

      <div
        id="reviews-rail"
        class="relative overflow-x-auto overflow-y-visible py-8 px-[var(--edge)] [-ms-overflow-style:none] [scrollbar-width:none]"
        style="scroll-padding-inline: var(--edge);"
        aria-label="Customer reviews carousel"
      >
        <style>#reviews-rail::-webkit-scrollbar{display:none}</style>

        <div class="flex gap-6 md:gap-8">
          <!-- Summary card with brand color accent -->
          <article 
            class="group w-80 md:w-96 shrink-0 rounded-3xl bg-gradient-to-br from-[#C48356]/5 to-white p-8 shadow-lg ring-1 ring-[#C48356]/20 hover:shadow-2xl hover:ring-[#C48356]/40 transition-all duration-300 hover:-translate-y-1"
            aria-label="Review summary"
          >
            <div class="mb-6 flex items-center gap-4">
              <div class="flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-[#C48356] to-[#B47347] text-white font-bold text-lg shadow-md">
                ★
              </div>
              <div>
                <div class="font-bold text-lg text-neutral-900">What Sets Us Apart</div>
                <div class="text-sm text-neutral-500">Customer highlights</div>
              </div>
            </div>
            <ul class="space-y-3">
              {summary.map((point) => (
                <li class="flex items-start gap-3 text-sm text-neutral-700 leading-relaxed">
                  <svg class="h-5 w-5 shrink-0 text-[#C48356] mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                  </svg>
                  <span>{point}</span>
                </li>
              ))}
            </ul>
          </article>

          <!-- Review cards with Schema.org markup -->
          {reviews.map((r) => (
            <article 
              class="group w-80 md:w-96 shrink-0 rounded-3xl bg-white p-8 shadow-lg ring-1 ring-neutral-200/70 hover:shadow-2xl hover:ring-[#C48356]/30 transition-all duration-300 hover:-translate-y-1"
              itemscope 
              itemtype="https://schema.org/Review"
            >
              <div class="flex items-center gap-4 mb-4">
                <div class="flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-[#C48356] to-[#B47347] text-white font-bold text-lg shadow-md">
                  {r.author_name.charAt(0)}
                </div>
                <div class="min-w-0 flex-1">
                  <div class="truncate font-semibold text-neutral-900" itemprop="author">{r.author_name}</div>
                  <time class="text-xs text-neutral-500" itemprop="datePublished">{r.relative_time_description}</time>
                </div>
              </div>

              <div class="flex gap-1 mb-4" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">
                <meta itemprop="ratingValue" content={r.rating.toString()} />
                <meta itemprop="bestRating" content="5" />
                {Array.from({ length: 5 }).map((_, i) => (
                  <svg viewBox="0 0 20 20" class={`h-5 w-5 ${i < r.rating ? 'fill-[#C48356]' : 'fill-neutral-300'}`} aria-hidden="true">
                    <path d="m10 15.27 5.18 3.05-1.64-5.81 4.46-3.86-5.86-.5L10 2 7.86 8.15l-5.86.5 4.46 3.86-1.64 5.81L10 15.27z"/>
                  </svg>
                ))}
              </div>

              <p class="text-sm md:text-base leading-relaxed text-neutral-700 line-clamp-6" itemprop="reviewBody">{r.text}</p>

              <div class="mt-6 pt-6 border-t border-neutral-100">
                <a 
                  href={r.author_url} 
                  target="_blank" 
                  rel="noopener" 
                  class="inline-flex items-center gap-2 text-sm font-medium text-[#C48356] hover:text-[#B47347] transition-colors group-hover:gap-3"
                >
                  Read full review
                  <svg class="h-4 w-4 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
              </div>
            </article>
          ))}
        </div>
      </div>
    </div>

    <!-- Instruction hint for desktop users -->
    <div class="mt-8 text-center">
      <p class="text-sm text-neutral-500 flex items-center justify-center gap-2">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18" />
        </svg>
        Hover and move your cursor to browse reviews
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </p>
    </div>

    <p class="mt-12 text-center text-xs text-neutral-400">
      Reviews and ratings are provided by Google and verified customers. © Google.
    </p>
  </div>
</section>

<script is:inline>
  (function () {
    const rail = document.getElementById('reviews-rail');
    if (!rail) return;

    // ----- TUNABLES -----
    const MAX_SPEED   = 6.5;  // lower = less sensitive overall (was 2.5)
    const DEAD_ZONE   = 0.12; // 0–0.2 = wider center area with no movement
    const CURVE       = 1.6;  // >1 softens response near center (1 = linear)
    const LERP        = 0.15; // 0.05–0.2: higher = snappier, lower = floatier
    const FRICTION    = 0.92; // used when we want inertia (not needed here much)

    let rafId = 0;
    let hovering = false;
    let velocity = 0;
    let targetVelocity = 0;

    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
    const lerp  = (a, b, t) => a + (b - a) * t;
    const sign  = (v) => (v < 0 ? -1 : 1);

    const step = () => {
      // ease current velocity toward the target for smoothness
      velocity = lerp(velocity, targetVelocity, LERP);

      if (!hovering && Math.abs(velocity) < 0.01) {
        rafId = 0;
        return;
      }

      const max = rail.scrollWidth - rail.clientWidth;
      rail.scrollLeft = clamp(rail.scrollLeft + velocity, 0, max);

      // tiny decay so it settles if the mouse stops right on the edge
      velocity *= FRICTION;

      rafId = requestAnimationFrame(step);
    };

    const kick = () => {
      if (!rafId) rafId = requestAnimationFrame(step);
    };

    rail.addEventListener('mousemove', (e) => {
      const r = rail.getBoundingClientRect();
      // map to -1..1
      let t = ((e.clientX - r.left) / r.width) * 2 - 1;

      // dead zone at the center
      if (Math.abs(t) < DEAD_ZONE) t = 0;
      else {
        // re-range outside the dead zone and apply a soft curve
        const edge = (Math.abs(t) - DEAD_ZONE) / (1 - DEAD_ZONE);
        const curved = Math.pow(edge, CURVE);
        t = curved * sign(t);
      }

      targetVelocity = t * MAX_SPEED;
      if (!hovering) {
        hovering = true;
        kick();
      }
    }, { passive: true });

    rail.addEventListener('mouseenter', () => {
      hovering = true;
      kick();
    }, { passive: true });

    rail.addEventListener('mouseleave', () => {
      hovering = false;
      targetVelocity = 0;
      // let the loop decay naturally; it'll stop when velocity is tiny
    }, { passive: true });

    // if user wheels, stop the hover-drive immediately
    rail.addEventListener('wheel', () => {
      hovering = false;
      targetVelocity = 0;
      velocity = 0;
      if (rafId) { cancelAnimationFrame(rafId); rafId = 0; }
    }, { passive: true });

    // optional: disable hover scroll on touch devices
    const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
    if (isTouch) {
      rail.removeEventListener('mousemove', () => {});
      rail.removeEventListener('mouseenter', () => {});
      rail.removeEventListener('mouseleave', () => {});
    }
  })();
</script>
